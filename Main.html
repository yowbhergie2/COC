<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CompTime Tracker</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
  <?!= HtmlService.createHtmlOutputFromFile('Styles').getContent() ?>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="#"><i class="bi bi-clock-history"></i> CompTime Tracker</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link active" href="#" data-page="dashboard">Dashboard</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#" data-page="employees">Employees</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">COC</a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#" data-page="log-overtime">Log Overtime</a></li>
              <li><a class="dropdown-item" href="#" data-page="generate-cert">Generate Certificate</a></li>
              <li><a class="dropdown-item" href="#" data-page="employee-ledger">View Employee Ledger</a></li>
              <li><a class="dropdown-item" href="#" data-page="log-cto">Log CTO</a></li>
            </ul>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#" data-page="reports">Reports</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">Master</a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#" data-page="holidays">Holidays</a></li>
              <li><a class="dropdown-item" href="#" data-page="configuration">System Configuration</a></li>
              <li><a class="dropdown-item" href="#" data-page="libraries">Libraries</a></li>
              <li><a class="dropdown-item" href="#" data-page="historical-balance">Historical Balance</a></li>
            </ul>
          </li>
        </ul>
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <span class="user-info" id="userEmail"><i class="bi bi-person-circle"></i> Loading...</span>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="content-wrapper">
    <?!= HtmlService.createHtmlOutputFromFile('Pages').getContent() ?>
  </div>

  <?!= HtmlService.createHtmlOutputFromFile('Modals').getContent() ?>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getAuth, signInWithCustomToken } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
    import { getFirestore, collection, query, where, orderBy, onSnapshot, doc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

    window.initializeApp = initializeApp;
    window.getAuth = getAuth;
    window.signInWithCustomToken = signInWithCustomToken;
    window.getFirestore = getFirestore;
    window.collection = collection;
    window.query = query;
    window.where = where;
    window.orderBy = orderBy;
    window.onSnapshot = onSnapshot;
    window.doc = doc;

    let db, auth, currentUser;
    let employeesData = [];
    let unsubscribers = [];
    let librariesData = { offices: [], positions: [] };
    let employeeSearchTerms = { active: '', inactive: '' };
    let librarySearchTerms = { offices: '', positions: '' };

    window.db = db;
    window.auth = auth;
    window.currentUser = currentUser;
    window.employeesData = employeesData;
    window.unsubscribers = unsubscribers;
    window.librariesData = librariesData;
    window.employeeSearchTerms = employeeSearchTerms;
    window.librarySearchTerms = librarySearchTerms;

    <?!= HtmlService.createHtmlOutputFromFile('CoreJS').getContent() ?>
    <?!= HtmlService.createHtmlOutputFromFile('EmployeesJS').getContent() ?>
    <?!= HtmlService.createHtmlOutputFromFile('OvertimeJS').getContent() ?>
    <?!= HtmlService.createHtmlOutputFromFile('TransactionsJS').getContent() ?>
    <?!= HtmlService.createHtmlOutputFromFile('MasterDataJS').getContent() ?>
  </script>
</body>
</html>
